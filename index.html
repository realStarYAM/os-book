<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OS Book - La Saga Windows</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@300;400;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body data-theme="default">
    <!-- UI Loader Overlay - SystÃ¨me de chargement d'interfaces -->
    <div id="ui-loader" class="ui-loader" aria-hidden="true" role="alert" aria-live="polite">
        <div class="loader-backdrop"></div>
        <div class="loader-content">
            <div class="loader-spinner"></div>
            <p class="loader-text">Chargement...</p>
        </div>
    </div>

    <!-- Ã‰cran d'intro cinÃ©matique -->
    <div id="intro-screen" class="intro-screen active">
        <div class="intro-content">
            <div class="intro-logo">
                <h1 class="intro-title">OS BOOK</h1>
                <p class="intro-subtitle">La Guerre des OS</p>
            </div>
            <div class="intro-teaser">
                <span class="teaser-line teaser-1">Windows 11</span>
                <span class="teaser-vs">vs</span>
                <span class="teaser-line teaser-2">ChromeOS</span>
            </div>
            <div class="intro-loading">
                <div class="intro-loading-bar"></div>
            </div>
        </div>
        <button id="intro-skip-btn" class="intro-skip-btn" aria-label="Passer l'intro">
            Passer â–¶
        </button>
        <p class="intro-skip-hint">Appuyez sur ESPACE ou ENTRÃ‰E pour passer</p>
    </div>

    <!-- Ã‰cran de dÃ©marrage -->
    <div id="start-screen" class="screen">
        <div class="title-container">
            <h1 class="main-title">OS BOOK</h1>
            <p class="subtitle">BIENVENUE</p>
            <div class="title-logo">
                <img src="logo/Windows_vista.png" alt="Windows Vista" class="floating-logo">
            </div>
        </div>

        <!-- ContrÃ´les Audio -->
        <div class="audio-controls-start">
            <button id="audio-toggle" class="audio-btn" title="Activer/DÃ©sactiver le son"
                aria-label="Activer ou dÃ©sactiver le son" aria-pressed="false">
                ğŸ”Š
            </button>
            <label for="volume-slider" class="sr-only">Volume</label>
            <input type="range" id="volume-slider" min="0" max="100" value="50" class="volume-slider">
        </div>

        <button id="start-btn" class="glow-button">
            <span>â–¶ COMMENCER</span>
        </button>

        <button id="chapter-btn" class="chapter-select-btn">
            <span>ğŸ“– Choisir un chapitre</span>
        </button>

        <button id="whatif-btn" class="chapter-select-btn whatif-btn">
            <span>ğŸ§© Mode What if</span>
            <span class="whatif-count" id="whatif-count" aria-label="Variantes actives">0</span>
        </button>

        <p class="audio-notice">ğŸµ Cette expÃ©rience contient de la musique et des effets sonores</p>
    </div>

    <!-- Modale de sÃ©lection de chapitres -->
    <div id="chapter-modal" class="chapter-modal">
        <div class="chapter-modal-backdrop"></div>
        <div class="chapter-modal-content">
            <button class="chapter-modal-close" aria-label="Fermer">âœ•</button>
            <h2 class="chapter-modal-title">ğŸ“– SÃ©lectionner un chapitre</h2>
            <p class="chapter-modal-subtitle">Certains chapitres sont verrouillÃ©s jusqu'Ã  la fin du jeu</p>
            <div class="chapter-list" id="chapter-list">
                <!-- Chapitres gÃ©nÃ©rÃ©s dynamiquement par JS -->
            </div>
        </div>
    </div>

    <!-- Modale What if -->
    <div id="whatif-modal" class="whatif-modal" aria-hidden="true">
        <div class="whatif-modal-backdrop"></div>
        <div class="whatif-modal-content">
            <button class="whatif-modal-close" aria-label="Fermer">âœ•</button>
            <h2 class="whatif-modal-title">ğŸ§© Mode What if</h2>
            <p class="whatif-modal-subtitle">Rejouez l'histoire avec des variantes alternatives</p>
            <div class="whatif-list" id="whatif-list">
                <!-- Variantes gÃ©nÃ©rÃ©es dynamiquement par JS -->
            </div>
            <div class="whatif-actions">
                <button id="whatif-reset" class="chapter-select-btn whatif-reset-btn">RÃ©initialiser</button>
                <button id="whatif-apply" class="glow-button whatif-apply-btn">
                    <span>Appliquer</span>
                </button>
            </div>
        </div>
    </div>


    <!-- ScÃ¨ne principale du Visual Novel -->
    <div id="vn-scene" class="screen">

        <!-- Ã‰cran de transition entre scÃ¨nes -->
        <div id="transition-overlay" class="transition-overlay">
            <p id="transition-text" class="transition-text">The Next Day...</p>
        </div>

        <!-- Fond HÃ´pital (ScÃ¨ne 1) -->
        <div id="hospital-bg" class="hospital-bg scene-bg active"></div>

        <!-- Fond CimetiÃ¨re (ScÃ¨ne 2) -->
        <div id="graveyard-bg" class="graveyard-bg scene-bg"></div>

        <!-- Fond Le Vide (ScÃ¨ne finale) -->
        <div id="void-bg" class="void-bg scene-bg"></div>

        <!-- Particules -->
        <div class="particles-bg"></div>

        <!-- Conteneur des tombes (ScÃ¨ne 2) -->
        <div id="graves-container" class="graves-container">
            <!-- Tombes gÃ©nÃ©rÃ©es dynamiquement par JS -->
        </div>

        <!-- Moniteur cardiaque -->
        <div id="heart-monitor" class="heart-monitor hidden">
            <div class="monitor-screen">
                <svg id="ecg-line" class="ecg-svg" viewBox="0 0 400 100" preserveAspectRatio="none">
                    <polyline id="ecg-path" class="ecg-path" points="0,50 400,50" />
                </svg>
            </div>
            <div class="monitor-label">â™¥ BPM: <span id="bpm-value">72</span></div>
        </div>

        <!-- Zone des personnages -->
        <div id="characters-container" class="characters-container hospital-scene">
            <div id="character-left" class="character-slot left">
                <img id="char-left-img" src="" alt="" class="character-sprite">
                <div id="char-left-fallback" class="character-fallback" aria-hidden="true">Image manquante</div>
                <div id="char-left-name" class="character-name-tag"></div>
            </div>

            <div id="character-center" class="character-slot center">
                <img id="char-center-img" src="" alt="" class="character-sprite">
                <div id="char-center-fallback" class="character-fallback" aria-hidden="true">Image manquante</div>
                <div id="char-center-name" class="character-name-tag"></div>
            </div>

            <div id="character-right" class="character-slot right">
                <img id="char-right-img" src="" alt="" class="character-sprite">
                <div id="char-right-fallback" class="character-fallback" aria-hidden="true">Image manquante</div>
                <div id="char-right-name" class="character-name-tag"></div>
            </div>
        </div>

        <!-- ContrÃ´les Audio In-Game -->
        <div class="audio-controls-game">
            <button id="audio-toggle-game" class="audio-btn-small" title="Son" aria-label="Activer ou dÃ©sactiver le son"
                aria-pressed="false">ğŸ”Š</button>
        </div>

        <!-- Menu Pause In-Game -->
        <div id="vn-menu" class="vn-menu">
            <button id="menu-btn" class="menu-btn" title="Menu (ESC)" aria-label="Ouvrir le menu pause"
                aria-expanded="false" aria-controls="menu-panel">â˜°</button>
            <div id="menu-backdrop" class="menu-backdrop" aria-hidden="true"></div>
            <div id="menu-panel" class="menu-panel" role="dialog" aria-modal="true" aria-labelledby="menu-title">
                <h2 id="menu-title" class="menu-title">â¸ï¸ Pause</h2>
                <div class="menu-buttons">
                    <button class="menu-action-btn" data-action="resume" tabindex="0">â–¶ï¸ Reprendre</button>
                    <button class="menu-action-btn" data-action="chapters" tabindex="0">ğŸ“– Choisir un chapitre</button>
                    <button class="menu-action-btn" data-action="timeline" tabindex="0">ğŸ•°ï¸ Timeline</button>
                    <button class="menu-action-btn" data-action="memories" tabindex="0">ğŸ“œ Carnet d'Oasis</button>
                    <button class="menu-action-btn" data-action="mute" tabindex="0">ğŸ”Š Son</button>
                    <div class="menu-speed-control">
                        <label for="typing-speed">âŒ¨ï¸ Vitesse du texte</label>
                        <input type="range" id="typing-speed" min="0" max="100" value="35" tabindex="0">
                        <span id="speed-label">Normal</span>
                    </div>
                    <hr class="menu-divider">
                    <button class="menu-action-btn warning" data-action="restart" tabindex="0">ğŸ”„ Recommencer</button>
                    <button class="menu-action-btn danger" data-action="toStart" tabindex="0">ğŸ  Ã‰cran titre</button>
                </div>
            </div>
        </div>

        <!-- Zone de dialogue -->
        <div class="dialogue-container">
            <div id="speaker-name" class="speaker-name"></div>
            <div id="dialogue-box" class="dialogue-box">
                <div id="dialogue-text" aria-live="polite" aria-atomic="true">
                    <p id="dialogue-visual" aria-hidden="true"></p>
                    <span id="dialogue-live" class="sr-only"></span>
                </div>
            </div>
            <div class="dialogue-controls">
                <span id="continue-indicator" class="continue-indicator">â–¼ Cliquez pour continuer</span>
            </div>
        </div>

        <!-- Indicateur de progression -->
        <div class="progress-bar">
            <div id="progress-fill" class="progress-fill"></div>
        </div>
    </div>

    <!-- Ã‰cran de fin avec gÃ©nÃ©rique dÃ©filant -->
    <div id="end-screen" class="screen">
        <!-- Le conteneur des crÃ©dits sera gÃ©nÃ©rÃ© dynamiquement par JS -->
        <div id="credits-container" class="credits-container"></div>
    </div>

    <!-- Media Player - Lecteur audio dynamique -->
    <div id="media-player" class="media-player" aria-label="Lecteur audio">
        <button id="media-player-close" class="mp-close-btn" aria-label="Fermer le lecteur">Ã—</button>

        <div class="mp-info">
            <span id="mp-title" class="mp-title">OS Book Soundtrack</span>
            <div class="mp-time">
                <span id="mp-current-time">0:00</span>
                <span class="mp-separator">/</span>
                <span id="mp-duration">0:00</span>
            </div>
        </div>

        <div class="mp-progress-container">
            <div class="mp-progress-bar">
                <div id="mp-progress-fill" class="mp-progress-fill"></div>
                <input type="range" id="mp-seek" class="mp-seek-slider" min="0" max="100" value="0"
                    aria-label="Position">
            </div>
        </div>

        <div class="mp-controls">
            <button id="mp-prev" class="mp-btn" aria-label="Piste prÃ©cÃ©dente">â®</button>
            <button id="mp-play" class="mp-btn mp-play-btn" aria-label="Lecture/Pause">â–¶</button>
            <button id="mp-next" class="mp-btn" aria-label="Piste suivante">â­</button>

            <div class="mp-volume-control">
                <button id="mp-mute" class="mp-btn mp-mute-btn" aria-label="Muet">ğŸ”Š</button>
                <input type="range" id="mp-volume" class="mp-volume-slider" min="0" max="100" value="50"
                    aria-label="Volume">
            </div>
        </div>
    </div>

    <!-- Bouton flottant pour ouvrir le player -->
    <button id="media-player-toggle" class="mp-toggle-btn" aria-label="Ouvrir le lecteur audio">ğŸµ</button>

    <!-- Timeline Interactive Modal -->
    <div id="timeline-modal" class="timeline-modal" aria-hidden="true">
        <div class="timeline-backdrop"></div>
        <div class="timeline-container">
            <button class="timeline-close-btn" aria-label="Fermer">Ã—</button>
            <h2 class="timeline-title">ğŸ•°ï¸ Timeline de l'Histoire</h2>
            <p class="timeline-subtitle">Explorez les arcs et revivez les moments clÃ©s</p>

            <div class="timeline-content" id="timeline-content">
                <!-- GÃ©nÃ©rÃ© dynamiquement par JS -->
            </div>

            <div class="timeline-legend">
                <span class="legend-item"><span class="legend-dot completed"></span> TerminÃ©</span>
                <span class="legend-item"><span class="legend-dot current"></span> En cours</span>
                <span class="legend-item"><span class="legend-dot locked"></span> VerrouillÃ©</span>
                <span class="legend-item"><span class="legend-dot secret"></span> Secret</span>
            </div>
        </div>
    </div>

    <!-- Carnet d'Oasis -->
    <div id="memory-modal" class="memory-modal" aria-hidden="true">
        <div class="memory-backdrop"></div>
        <div class="memory-container">
            <button class="memory-close-btn" aria-label="Fermer">Ã—</button>
            <h2 class="memory-title">ğŸ“œ Carnet d'Oasis</h2>
            <p class="memory-subtitle">Les derniÃ¨res rÃ©pliques gravÃ©es dans le sable numÃ©rique</p>

            <div class="memory-content" id="memory-content">
                <!-- GÃ©nÃ©rÃ© dynamiquement par JS -->
            </div>

            <div class="memory-actions">
                <button id="memory-clear" class="chapter-select-btn memory-clear-btn">Effacer</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>
